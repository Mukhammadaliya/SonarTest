<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Fazo sync</title>
<link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="assets/fontawesome/css/all.min.css?_=2107151219" rel="stylesheet" type="text/css">
</head>
<body class="mt-5">
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="card card-custom p-2 w-100">
        <div class="card-header">
          <div class="row justify-content-between">
            <div class="col-sm-11">
              <label>From</label>
              <input type="text" class="form-control" id="url1"/>
            </div>
            <div class="col-sm-2 align-self-center text-center">
              <br>
              <button type="button" class="btn btn-default" id="exchange"><i class="fas fa-exchange-alt"></i></button>
            </div>
            <div class="col-sm-11">
              <label>To</label>
              <input type="text" class="form-control" id="url2"/>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-sm-auto d-flex">
              <button type="button" class="btn btn-success" id="go">Go!</button>
            </div>
            <div class="class">
              <button type="button" class="btn btn-info" id="copy">Copy</button>
            </div>
          </div>
        </div>
        <div class="card-body mt-3 p-0">
          <div class="p-2" id="code"></div>
        </div>
      </div>
    </div>
  </nav>
<script src="assets/jquery/jquery-2.2.0.min.js"></script>
<script>
  $(function(){
    var $url1 = $('#url1'), $url2 = $('#url2'), $code = $('#code'), $copy = $('#copy');
    $('#go').click(function() {
      fetchDiff($url1, $url2);
    });

    $(document.body).keyup((event) => {
    	if (event.keyCode === 13) $("#go").click();
    });

    $copy.click(() => {
      const area = document.createElement('textarea');
      area.value = $code.text().trim();
      window.document.body.appendChild(area);
      area.select();
      window.document.execCommand('copy');
      window.document.body.removeChild(area);

      $copy.html('Copied <i class="fas fa-check"></i>');
      setTimeout(() => {
        $copy.html('Copy');
      }, 2000);
    });

    $('#exchange').click(() => {
      let temp = $url1.val();
      $url1.val($url2.val());
      $url2.val(temp);
    });

    function fetchDiff($urlFrom, $urlTo) {
      $code.addClass("alert alert-success");
      $code.html('Loading...');
      $.post('dev/fazo_diff', JSON.stringify({
      	from:$urlFrom.val(),
      	to:$urlTo.val()
      })).done(function(d) {
        $code.removeClass("alert alert-danger");
        $code.html(d);
      }).fail(function(e) {
        $code.addClass("alert alert-danger");
        $code.text(e.responseText);
      });
    }
  });
</script>
</body>
</html>